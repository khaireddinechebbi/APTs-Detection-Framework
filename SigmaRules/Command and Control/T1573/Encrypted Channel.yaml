title: Suspicious PowerShell HTTPS Network Connections (Sysmon)
id: 5b9f7d3a-2c8e-4a7c-a8f1-6d7e5f4c3b2a
status: experimental
description: Detects suspicious PowerShell processes establishing HTTPS-like connections over common SSL ports using .NET TcpClient and SslStream, including command execution via Invoke-Expression or iex.
author: Khaireddine
date: 2025/09/11
logsource:
  product: windows
  category: process_creation
  service: sysmon
detection:
  suspicious_powershell_ssl:
    EventID: 1
    Image|endswith: '\powershell.exe'
    CommandLine|contains|all:
      - 'TcpClient'
      - 'SslStream'
      - '{$True}'
      - 'AuthenticateAsClient'
      - 'Tls12'
    CommandLine|contains:
      - 'iex'
      - 'Invoke-Expression'
  condition: suspicious_powershell_ssl
fields: 
  - UtcTime
  - Image
  - CommandLine
  - ParentImage
  - ParentCommandLine
  - User
  - Hostname
falsepositives:
  - Legitimate scripts establishing SSL/TCP connections
  - internal pen-testing tools
level: high
tags:
  - attack.command_and_control
  - attack.t1573
