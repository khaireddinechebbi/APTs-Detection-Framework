title: Suspicious Regsvr32 Execution with Scriptlet/COM Abuse
id: 7d3c8a2b-4f5e-4d8c-9a1b-6c2d9e8f1a34
status: experimental
description: Detects suspicious regsvr32.exe execution with automation flags (/s /i) from command interpreters, potentially indicating scriptlet/COM abuse for defense evasion (T1218.010).
author: Khaireddine
date: 2025/09/16
logsource:
    category: process_creation
    product: windows
    service: sysmon
detection:
    selection_event:
        EventID: 1
    selection_target:
        Image|endswith: '\regsvr32.exe'
    selection_parent:
        ParentImage|endswith:
            - '\cmd.exe'
            - '\powershell.exe'
    selection_cmdline_flags:
        CommandLine|contains|all:
            - '/s'
            - '/i'
            - '.dll'
    selection_parent_conditional:
        ParentCommandLine|contains|all:
          - '/s'
          - ' IF '
          - ' ELSE '
    selection_parent_temp:
        ParentCommandLine|contains|all:
          - '/s'
          - '%temp%'
    
    condition: selection_event and selection_target and selection_parent and 
              (selection_cmdline_flags or selection_parent_conditional or selection_parent_temp)
fields:
    - CommandLine
    - ParentCommandLine
    - User
    - ProcessId
    - ParentProcessId
falsepositives:
    - Legitimate system administration scripts using regsvr32 for COM registration
    - Software installation/update scripts
level: high
tags:
    - attack.defense_evasion
    - attack.t1218
    - attack.t1218.010
