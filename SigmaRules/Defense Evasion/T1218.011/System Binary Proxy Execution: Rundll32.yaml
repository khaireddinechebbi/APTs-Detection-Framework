title: Suspicious Rundll32 Execution Patterns (Sysmon)
id: 4f94cfc1-7b3b-41e2-9d9a-3c5f52a6f31a
status: experimental
description: Detects suspicious rundll32.exe executions that may indicate DLL execution abuse (MITRE ATT&CK T1218.011).
author: Khaireddine
date: 2025/09/19
references:
  - https://attack.mitre.org/techniques/T1218/011/
logsource:
  product: windows
  category: process_creation
  service: sysmon
detection:
  selection_image:
    EventID: 1
    Image|endswith: '\rundll32.exe'
  parent_cmd_ps:
    ParentImage|endswith:
      - '\cmd.exe'
      - '\powershell.exe'
  cmdline_dll_comma:
    CommandLine|contains|all:
      - '.dll'
      - ',#'
  cmdline_has_dll_or_cpl:
    CommandLine|contains:
      - '.dll'
      - '.cpl'
  cmdline_shell32_abuse:
    CommandLine|contains|all:
      - 'shell32.dll,Control_RunDLL'
  cmdline_cpl:
    CommandLine|contains: '.cpl'
  parent_rundll32:
    ParentImage|endswith: '\rundll32.exe'
  condition: >
    selection_image 
    and (
      (parent_cmd_ps and (cmdline_dll_comma or not cmdline_has_dll_or_cpl or (cmdline_shell32_abuse and not cmdline_cpl)))
      or parent_rundll32
    )
fields:
  - UtcTime
  - Image
  - CommandLine
  - ParentImage
  - User
falsepositives:
  - Rare legitimate rundll32 calls with custom arguments
level: high
tags:
  - attack.defense_evasion
  - attack.t1218.011
