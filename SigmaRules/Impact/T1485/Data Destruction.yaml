title: Suspicious Data Destruction via wsmprovhost Parent
id: 9c3f2a7b-2d1e-4b6f-9a7e-5f1d2b8c4e66
status: experimental
description: Detects potential data destruction activity where cmd.exe or PowerShell is launched by `wsmprovhost.exe` and executes destructive utilities or commands such as plink with .removeall, sdelete with -accepteula, or cipher with /w:. This may indicate deliberate destructive actions or cleanup attempts initiated over remote management channels.
author: Khaireddine
date: 2025/09/16
logsource:
  product: windows
  category: process_creation
  service: sysmon
detection:
  selection_image:
    EventID: 1
    ParentImage|endswith: '\wsmprovhost.exe'
    Image|endswith:
      - '\cmd.exe'
      - '\powershell.exe'
  selections|1:
    CommandLine|contains|all:
      - 'plink.exe'
      - '.removeall'
  selections|2:
    CommandLine|contains|all: 
      - 'sdelete.exe'
      - '-accepteula'
  selections|3:
    CommandLine|contains|all: 
      - 'cipher'
      - '/w:'
  condition: selection_image and (1 of selections)
fields:
  - UtcTime
  - Image
  - CommandLine
  - ParentImage
  - ParentCommandLine
  - User
  - Hostname
falsepositives:
  - Legitimate administrative disk maintenance or secure-delete operations
  - Automated provisioning/cleanup scripts run via remote management (WS-Man)
  - Enterprise management tools that invoke cipher/sdelete as part of imaging or decommission workflows
level: high
tags:
  - attack.impact
  - attack.t1485