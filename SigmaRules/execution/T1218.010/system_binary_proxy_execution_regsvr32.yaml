title: regsvr32 Suspicious Execution with /s and /i Options (Sysmon)
id: c1d7e8f2-6b4a-4f9c-a2d1-5e7f8c3a2b4d
status: experimental
description: Detects regsvr32.exe execution using /s and /i options with suspicious DLL or scriptlet loading, including suspicious parent execution from cmd.exe or powershell.exe that contain IF/ELSE logic or temp path usage. This is often associated with T1218.010 regsvr32 LOLBAS abuse.
author: Khaireddine
date: 2025/08/18
logsource:
  product: windows
  category: process_creation
  service: sysmon
detection:
  sel_regsvr32_susp:
    Image|endswith: '\regsvr32.exe'
    CommandLine|contains:
      - '/s'
    CommandLine|contains_any:
      - '/i'
      - '.dll'
  sel_parent_susp:
    ParentImage|endswith:
      - '\cmd.exe'
      - '\powershell.exe'
    ParentCommandLine|contains_any:
      - 'IF'
      - 'ELSE'
      - '%temp%'
  condition: sel_regsvr32_susp or (sel_regsvr32_susp and sel_parent_susp)
fields:
  - UtcTime
  - Image
  - CommandLine
  - ParentImage
  - ParentCommandLine
  - User
falsepositives:
  - Legitimate software installers or uninstallers using regsvr32 with DLLs
  - Rare automation scripts invoking regsvr32 with IF/ELSE or %temp% logic
level: high
tags:
  - attack.execution
  - attack.t1218
  - attack.t1218.010
