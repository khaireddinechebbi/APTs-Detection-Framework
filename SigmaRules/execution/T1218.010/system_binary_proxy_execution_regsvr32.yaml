title: regsvr32/SCROBJ Remote Script Execution (Sysmon)
id: c1d7e8f2-6b4a-4f9c-a2d1-5e7f8c3a2b4d
status: experimental
description: Detects regsvr32.exe execution of scrobj.dll with remote .sct scripts, including suspicious parent execution from cmd.exe or powershell.exe with IF/ELSE or temp path usage.
author: Khaireddine
date: 2025/08/18
logsource:
  product: windows
  category: process_creation
  service: sysmon
detection:
  sel_regsvr32:
    Image|endswith: '\regsvr32.exe'
    CommandLine|contains_all:
      - 'scrobj.dll'
      - '/i'
      - '.sct'
  sel_parent_susp:
    ParentImage|endswith:
      - '\cmd.exe'
      - '\powershell.exe'
    ParentCommandLine|contains_any:
      - 'IF'
      - 'ELSE'
      - '%temp%'
  condition: sel_regsvr32 or (sel_regsvr32 and sel_parent_susp)
fields:
  - UtcTime
  - Image
  - CommandLine
  - ParentImage
  - ParentCommandLine
  - User
falsepositives:
  - Rare legitimate automation scripts that use regsvr32 with scrobj.dll
level: high
tags:
  - attack.execution
  - attack.t1218
  - attack.t1218.010
