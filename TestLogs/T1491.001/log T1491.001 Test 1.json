{
  "@timestamp": [
    "2025-09-16T11:57:01.580Z"
  ],
  "agent.ephemeral_id": [
    "5e3f59aa-7543-4e93-99bd-901ff6b9334d"
  ],
  "agent.hostname": [
    "windows10"
  ],
  "agent.id": [
    "2a749be6-7546-4730-bfff-3e53e1d899ad"
  ],
  "agent.name": [
    "windows10"
  ],
  "agent.type": [
    "winlogbeat"
  ],
  "agent.version": [
    "9.1.2"
  ],
  "ecs.version": [
    "8.17.0"
  ],
  "event.action": [
    "Process creation"
  ],
  "event.category": [
    "process"
  ],
  "event.code": [
    "1"
  ],
  "event.created": [
    "2025-09-16T11:57:03.200Z"
  ],
  "event.ingested": [
    "2025-09-16T12:06:28.712Z"
  ],
  "event.kind": [
    "event"
  ],
  "event.module": [
    "sysmon"
  ],
  "event.provider": [
    "Microsoft-Windows-Sysmon"
  ],
  "event.type": [
    "start"
  ],
  "host.architecture": [
    "x86_64"
  ],
  "host.hostname": [
    "windows10"
  ],
  "host.id": [
    "9602231e-bedc-4571-bb7f-bfa9fca7b1e1"
  ],
  "host.ip": [
    "fe80::5588:11c4:b507:8fc7",
    "30.30.30.48"
  ],
  "host.mac": [
    "08-00-27-10-06-88"
  ],
  "host.name": [
    "windows10"
  ],
  "host.os.build": [
    "19045.6332"
  ],
  "host.os.family": [
    "windows"
  ],
  "host.os.kernel": [
    "10.0.19041.6328 (WinBuild.160101.0800)"
  ],
  "host.os.name": [
    "Windows 10 Enterprise Evaluation"
  ],
  "host.os.name.text": [
    "Windows 10 Enterprise Evaluation"
  ],
  "host.os.platform": [
    "windows"
  ],
  "host.os.type": [
    "windows"
  ],
  "host.os.version": [
    "10.0"
  ],
  "log.level": [
    "information"
  ],
  "message": [
    "Process Create:\nRuleName: -\nUtcTime: 2025-09-16 11:57:01.580\nProcessGuid: {9602231E-508D-68C9-4B02-000000004300}\nProcessId: 9372\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\nFileVersion: 10.0.19041.3996 (WinBuild.160101.0800)\nDescription: Windows PowerShell\nProduct: Microsoft® Windows® Operating System\nCompany: Microsoft Corporation\nOriginalFileName: PowerShell.EXE\nCommandLine: \"powershell.exe\" & {$url = \\\"\"https://redcanary.com/wp-content/uploads/Atomic-Red-Team-Logo.png\\\"\"\n$imgLocation = \\\"\"$env:TEMP\\T1491.001-newWallpaper.png\\\"\"\n$orgWallpaper = (Get-ItemProperty -Path Registry::'HKEY_CURRENT_USER\\Control Panel\\Desktop\\' -Name WallPaper).WallPaper\n$orgWallpaper | Out-File -FilePath \\\"\"$env:TEMP\\T1491.001-OrginalWallpaperLocation\\\"\"\n$updateWallpapercode = @' \nusing System.Runtime.InteropServices; \nnamespace Win32{\n\n    public class Wallpaper{ \n        [DllImport(\\\"\"user32.dll\\\"\", CharSet=CharSet.Auto)] \n         static extern int SystemParametersInfo (int uAction , int uParam , string lpvParam , int fuWinIni) ; \n         \n         public static void SetWallpaper(string thePath){ \n            SystemParametersInfo(20,0,thePath,3); \n        }\n    }\n} \n'@\n$wc = New-Object System.Net.WebClient  \ntry{  \n    $wc.DownloadFile($url, $imgLocation)\n    add-type $updateWallpapercode \n    [Win32.Wallpaper]::SetWallpaper($imgLocation)\n} \ncatch [System.Net.WebException]{  \n    Write-Host(\\\"\"Cannot download $url\\\"\") \n    add-type $updateWallpapercode \n    [Win32.Wallpaper]::SetWallpaper($imgLocation)\n} \nfinally{    \n    $wc.Dispose()  \n}}\nCurrentDirectory: C:\\Users\\KHAIRE~1\\AppData\\Local\\Temp\\\nUser: WINDOWS10\\khaireddine\nLogonGuid: {9602231E-4E0C-68C9-5E08-6B0000000000}\nLogonId: 0x6b085e\nTerminalSessionId: 0\nIntegrityLevel: High\nHashes: SHA256=9785001B0DCF755EDDB8AF294A373C0B87B2498660F724E76C4D53F9C217C7A3,IMPHASH=3D08F4848535206D772DE145804FF4B6\nParentProcessGuid: {00000000-0000-0000-0000-000000000000}\nParentProcessId: 5972\nParentImage: -\nParentCommandLine: -\nParentUser: -"
  ],
  "process.args": [
    "powershell.exe",
    "&",
    "{$url",
    "=",
    "\"https://redcanary.com/wp-content/uploads/Atomic-Red-Team-Logo.png\"\n$imgLocation",
    "=",
    "\"$env:TEMP\\T1491.001-newWallpaper.png\"\n$orgWallpaper",
    "=",
    "(Get-ItemProperty",
    "-Path",
    "Registry::'HKEY_CURRENT_USER\\Control",
    "Panel\\Desktop\\'",
    "-Name",
    "WallPaper).WallPaper\n$orgWallpaper",
    "|",
    "Out-File",
    "-FilePath",
    "\"$env:TEMP\\T1491.001-OrginalWallpaperLocation\"\n$updateWallpapercode",
    "=",
    "@'",
    "\nusing",
    "System.Runtime.InteropServices;",
    "\nnamespace",
    "Win32{\n\n",
    "public",
    "class",
    "Wallpaper{",
    "\n",
    "[DllImport(\"user32.dll\",",
    "CharSet=CharSet.Auto)]",
    "\n",
    "static",
    "extern",
    "int",
    "SystemParametersInfo",
    "(int",
    "uAction",
    ",",
    "int",
    "uParam",
    ",",
    "string",
    "lpvParam",
    ",",
    "int",
    "fuWinIni)",
    ";",
    "\n",
    "\n",
    "public",
    "static",
    "void",
    "SetWallpaper(string",
    "thePath){",
    "\n",
    "SystemParametersInfo(20,0,thePath,3);",
    "\n",
    "}\n",
    "}\n}",
    "\n'@\n$wc",
    "=",
    "New-Object",
    "System.Net.WebClient",
    "\ntry{",
    "\n",
    "$wc.DownloadFile($url,",
    "$imgLocation)\n",
    "add-type",
    "$updateWallpapercode",
    "\n",
    "[Win32.Wallpaper]::SetWallpaper($imgLocation)\n}",
    "\ncatch",
    "[System.Net.WebException]{",
    "\n",
    "Write-Host(\"Cannot download $url\")",
    "\n",
    "add-type",
    "$updateWallpapercode",
    "\n",
    "[Win32.Wallpaper]::SetWallpaper($imgLocation)\n}",
    "\nfinally{",
    "\n",
    "$wc.Dispose()",
    "\n}}"
  ],
  "process.args_count": [
    84
  ],
  "process.command_line": [
    "\"powershell.exe\" & {$url = \\\"\"https://redcanary.com/wp-content/uploads/Atomic-Red-Team-Logo.png\\\"\"\n$imgLocation = \\\"\"$env:TEMP\\T1491.001-newWallpaper.png\\\"\"\n$orgWallpaper = (Get-ItemProperty -Path Registry::'HKEY_CURRENT_USER\\Control Panel\\Desktop\\' -Name WallPaper).WallPaper\n$orgWallpaper | Out-File -FilePath \\\"\"$env:TEMP\\T1491.001-OrginalWallpaperLocation\\\"\"\n$updateWallpapercode = @' \nusing System.Runtime.InteropServices; \nnamespace Win32{\n\n    public class Wallpaper{ \n        [DllImport(\\\"\"user32.dll\\\"\", CharSet=CharSet.Auto)] \n         static extern int SystemParametersInfo (int uAction , int uParam , string lpvParam , int fuWinIni) ; \n         \n         public static void SetWallpaper(string thePath){ \n            SystemParametersInfo(20,0,thePath,3); \n        }\n    }\n} \n'@\n$wc = New-Object System.Net.WebClient  \ntry{  \n    $wc.DownloadFile($url, $imgLocation)\n    add-type $updateWallpapercode \n    [Win32.Wallpaper]::SetWallpaper($imgLocation)\n} \ncatch [System.Net.WebException]{  \n    Write-Host(\\\"\"Cannot download $url\\\"\") \n    add-type $updateWallpapercode \n    [Win32.Wallpaper]::SetWallpaper($imgLocation)\n} \nfinally{    \n    $wc.Dispose()  \n}}"
  ],
  "process.command_line.text": [
    "\"powershell.exe\" & {$url = \\\"\"https://redcanary.com/wp-content/uploads/Atomic-Red-Team-Logo.png\\\"\"\n$imgLocation = \\\"\"$env:TEMP\\T1491.001-newWallpaper.png\\\"\"\n$orgWallpaper = (Get-ItemProperty -Path Registry::'HKEY_CURRENT_USER\\Control Panel\\Desktop\\' -Name WallPaper).WallPaper\n$orgWallpaper | Out-File -FilePath \\\"\"$env:TEMP\\T1491.001-OrginalWallpaperLocation\\\"\"\n$updateWallpapercode = @' \nusing System.Runtime.InteropServices; \nnamespace Win32{\n\n    public class Wallpaper{ \n        [DllImport(\\\"\"user32.dll\\\"\", CharSet=CharSet.Auto)] \n         static extern int SystemParametersInfo (int uAction , int uParam , string lpvParam , int fuWinIni) ; \n         \n         public static void SetWallpaper(string thePath){ \n            SystemParametersInfo(20,0,thePath,3); \n        }\n    }\n} \n'@\n$wc = New-Object System.Net.WebClient  \ntry{  \n    $wc.DownloadFile($url, $imgLocation)\n    add-type $updateWallpapercode \n    [Win32.Wallpaper]::SetWallpaper($imgLocation)\n} \ncatch [System.Net.WebException]{  \n    Write-Host(\\\"\"Cannot download $url\\\"\") \n    add-type $updateWallpapercode \n    [Win32.Wallpaper]::SetWallpaper($imgLocation)\n} \nfinally{    \n    $wc.Dispose()  \n}}"
  ],
  "process.entity_id": [
    "{9602231E-508D-68C9-4B02-000000004300}"
  ],
  "process.executable": [
    "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
  ],
  "process.executable.text": [
    "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
  ],
  "process.hash.sha256": [
    "9785001b0dcf755eddb8af294a373c0b87b2498660f724e76c4d53f9c217c7a3"
  ],
  "process.name": [
    "powershell.exe"
  ],
  "process.name.text": [
    "powershell.exe"
  ],
  "process.parent.pid": [
    5972
  ],
  "process.pe.company": [
    "Microsoft Corporation"
  ],
  "process.pe.description": [
    "Windows PowerShell"
  ],
  "process.pe.file_version": [
    "10.0.19041.3996 (WinBuild.160101.0800)"
  ],
  "process.pe.imphash": [
    "3d08f4848535206d772de145804ff4b6"
  ],
  "process.pe.original_file_name": [
    "PowerShell.EXE"
  ],
  "process.pe.product": [
    "Microsoft® Windows® Operating System"
  ],
  "process.pid": [
    9372
  ],
  "process.working_directory": [
    "C:\\Users\\KHAIRE~1\\AppData\\Local\\Temp\\"
  ],
  "process.working_directory.text": [
    "C:\\Users\\KHAIRE~1\\AppData\\Local\\Temp\\"
  ],
  "related.hash": [
    "9785001b0dcf755eddb8af294a373c0b87b2498660f724e76c4d53f9c217c7a3",
    "3d08f4848535206d772de145804ff4b6"
  ],
  "related.user": [
    "khaireddine"
  ],
  "user.domain": [
    "WINDOWS10"
  ],
  "user.id": [
    "S-1-5-18"
  ],
  "user.name": [
    "khaireddine"
  ],
  "user.name.text": [
    "khaireddine"
  ],
  "winlog.channel": [
    "Microsoft-Windows-Sysmon/Operational"
  ],
  "winlog.computer_name": [
    "windows10"
  ],
  "winlog.event_data.Company": [
    "Microsoft Corporation"
  ],
  "winlog.event_data.Description": [
    "Windows PowerShell"
  ],
  "winlog.event_data.FileVersion": [
    "10.0.19041.3996 (WinBuild.160101.0800)"
  ],
  "winlog.event_data.IntegrityLevel": [
    "High"
  ],
  "winlog.event_data.LogonGuid": [
    "{9602231E-4E0C-68C9-5E08-6B0000000000}"
  ],
  "winlog.event_data.LogonId": [
    "0x6b085e"
  ],
  "winlog.event_data.Product": [
    "Microsoft® Windows® Operating System"
  ],
  "winlog.event_data.TerminalSessionId": [
    "0"
  ],
  "winlog.event_id": [
    "1"
  ],
  "winlog.opcode": [
    "Info"
  ],
  "winlog.process.pid": [
    2600
  ],
  "winlog.process.thread.id": [
    4296
  ],
  "winlog.provider_guid": [
    "{5770385F-C22A-43E0-BF4C-06F5698FFBD9}"
  ],
  "winlog.provider_name": [
    "Microsoft-Windows-Sysmon"
  ],
  "winlog.record_id": [
    "727549"
  ],
  "winlog.task": [
    "Process Create (rule: ProcessCreate)"
  ],
  "winlog.user.domain": [
    "NT AUTHORITY"
  ],
  "winlog.user.identifier": [
    "S-1-5-18"
  ],
  "winlog.user.name": [
    "SYSTEM"
  ],
  "winlog.user.type": [
    "User"
  ],
  "winlog.version": [
    5
  ],
  "_id": "m6BrUpkBFGjYcBhfUbI2",
  "_index": ".ds-winlogbeat-9.1.2-2025.08.17-000001",
  "_score": null
}