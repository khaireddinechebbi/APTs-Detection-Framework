{
  "@timestamp": [
    "2025-09-15T14:59:19.426Z"
  ],
  "agent.ephemeral_id": [
    "aeba73d9-cc6e-4e63-97e2-f1b43f1f9f5f"
  ],
  "agent.hostname": [
    "windows10"
  ],
  "agent.id": [
    "2a749be6-7546-4730-bfff-3e53e1d899ad"
  ],
  "agent.name": [
    "windows10"
  ],
  "agent.type": [
    "winlogbeat"
  ],
  "agent.version": [
    "9.1.2"
  ],
  "ecs.version": [
    "8.17.0"
  ],
  "event.action": [
    "Process creation"
  ],
  "event.category": [
    "process"
  ],
  "event.code": [
    "1"
  ],
  "event.created": [
    "2025-09-15T14:59:22.989Z"
  ],
  "event.ingested": [
    "2025-09-15T15:00:00.549Z"
  ],
  "event.kind": [
    "event"
  ],
  "event.module": [
    "sysmon"
  ],
  "event.provider": [
    "Microsoft-Windows-Sysmon"
  ],
  "event.type": [
    "start"
  ],
  "host.architecture": [
    "x86_64"
  ],
  "host.hostname": [
    "windows10"
  ],
  "host.id": [
    "9602231e-bedc-4571-bb7f-bfa9fca7b1e1"
  ],
  "host.ip": [
    "fe80::5588:11c4:b507:8fc7",
    "30.30.30.48"
  ],
  "host.mac": [
    "08-00-27-10-06-88"
  ],
  "host.name": [
    "windows10"
  ],
  "host.os.build": [
    "19045.6332"
  ],
  "host.os.family": [
    "windows"
  ],
  "host.os.kernel": [
    "10.0.19041.6328 (WinBuild.160101.0800)"
  ],
  "host.os.name": [
    "Windows 10 Enterprise Evaluation"
  ],
  "host.os.name.text": [
    "Windows 10 Enterprise Evaluation"
  ],
  "host.os.platform": [
    "windows"
  ],
  "host.os.type": [
    "windows"
  ],
  "host.os.version": [
    "10.0"
  ],
  "log.level": [
    "information"
  ],
  "message": [
    "Process Create:\nRuleName: -\nUtcTime: 2025-09-15 14:59:19.426\nProcessGuid: {9602231E-29C7-68C8-C101-000000004200}\nProcessId: 3376\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\nFileVersion: 10.0.19041.3996 (WinBuild.160101.0800)\nDescription: Windows PowerShell\nProduct: Microsoft® Windows® Operating System\nCompany: Microsoft Corporation\nOriginalFileName: PowerShell.EXE\nCommandLine: \"powershell.exe\" & {# Add user32.dll for keybd_event\nAdd-Type @\\\"\"\n    using System;\n    using System.Runtime.InteropServices;\n    public class K {\n        [DllImport(\\\"\"user32.dll\\\"\")]\n        public static extern void keybd_event(byte bVk, byte bScan, uint dwFlags, UIntPtr dwExtraInfo);\n    }\n\\\"\"@\n\n# Virtual key codes\n$VK_LWIN, $VK_R, $KEYDOWN, $KEYUP = 0x5B, 0x52, 0x0000, 0x0002\n\n# Open Run dialog (Win+R)\n[K]::keybd_event($VK_LWIN, 0, $KEYDOWN, [UIntPtr]::Zero)\n[K]::keybd_event($VK_R, 0, $KEYDOWN, [UIntPtr]::Zero)\n[K]::keybd_event($VK_R, 0, $KEYUP, [UIntPtr]::Zero)\n[K]::keybd_event($VK_LWIN, 0, $KEYUP, [UIntPtr]::Zero)\n\n# Short delay for Run dialog\nStart-Sleep -Milliseconds 500\nAdd-Type -AssemblyName System.Windows.Forms\n[System.Windows.Forms.SendKeys]::SendWait(\\\"\"cmd /c powershell -ec \\\"\" + [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes('calc.exe')) + \\\"\"{ENTER}\\\"\")}\nCurrentDirectory: C:\\Users\\KHAIRE~1\\AppData\\Local\\Temp\\\nUser: WINDOWS10\\khaireddine\nLogonGuid: {9602231E-1740-68C8-17F0-250000000000}\nLogonId: 0x25f017\nTerminalSessionId: 0\nIntegrityLevel: High\nHashes: SHA256=9785001B0DCF755EDDB8AF294A373C0B87B2498660F724E76C4D53F9C217C7A3,IMPHASH=3D08F4848535206D772DE145804FF4B6\nParentProcessGuid: {00000000-0000-0000-0000-000000000000}\nParentProcessId: 2012\nParentImage: -\nParentCommandLine: -\nParentUser: -"
  ],
  "process.args": [
    "powershell.exe",
    "&",
    "{#",
    "Add",
    "user32.dll",
    "for",
    "keybd_event\nAdd-Type",
    "@\"\n    using System;\n    using System.Runtime.InteropServices;\n    public class K {\n        [DllImport(\"user32.dll\")]\n        public static extern void keybd_event(byte bVk, byte bScan, uint dwFlags, UIntPtr dwExtraInfo);\n    }\n\"@\n\n#",
    "Virtual",
    "key",
    "codes\n$VK_LWIN,",
    "$VK_R,",
    "$KEYDOWN,",
    "$KEYUP",
    "=",
    "0x5B,",
    "0x52,",
    "0x0000,",
    "0x0002\n\n#",
    "Open",
    "Run",
    "dialog",
    "(Win+R)\n[K]::keybd_event($VK_LWIN,",
    "0,",
    "$KEYDOWN,",
    "[UIntPtr]::Zero)\n[K]::keybd_event($VK_R,",
    "0,",
    "$KEYDOWN,",
    "[UIntPtr]::Zero)\n[K]::keybd_event($VK_R,",
    "0,",
    "$KEYUP,",
    "[UIntPtr]::Zero)\n[K]::keybd_event($VK_LWIN,",
    "0,",
    "$KEYUP,",
    "[UIntPtr]::Zero)\n\n#",
    "Short",
    "delay",
    "for",
    "Run",
    "dialog\nStart-Sleep",
    "-Milliseconds",
    "500\nAdd-Type",
    "-AssemblyName",
    "System.Windows.Forms\n[System.Windows.Forms.SendKeys]::SendWait(\"cmd /c powershell -ec \"",
    "+",
    "[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes('calc.exe'))",
    "+",
    "\"{ENTER}\")}"
  ],
  "process.args_count": [
    48
  ],
  "process.command_line": [
    "\"powershell.exe\" & {# Add user32.dll for keybd_event\nAdd-Type @\\\"\"\n    using System;\n    using System.Runtime.InteropServices;\n    public class K {\n        [DllImport(\\\"\"user32.dll\\\"\")]\n        public static extern void keybd_event(byte bVk, byte bScan, uint dwFlags, UIntPtr dwExtraInfo);\n    }\n\\\"\"@\n\n# Virtual key codes\n$VK_LWIN, $VK_R, $KEYDOWN, $KEYUP = 0x5B, 0x52, 0x0000, 0x0002\n\n# Open Run dialog (Win+R)\n[K]::keybd_event($VK_LWIN, 0, $KEYDOWN, [UIntPtr]::Zero)\n[K]::keybd_event($VK_R, 0, $KEYDOWN, [UIntPtr]::Zero)\n[K]::keybd_event($VK_R, 0, $KEYUP, [UIntPtr]::Zero)\n[K]::keybd_event($VK_LWIN, 0, $KEYUP, [UIntPtr]::Zero)\n\n# Short delay for Run dialog\nStart-Sleep -Milliseconds 500\nAdd-Type -AssemblyName System.Windows.Forms\n[System.Windows.Forms.SendKeys]::SendWait(\\\"\"cmd /c powershell -ec \\\"\" + [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes('calc.exe')) + \\\"\"{ENTER}\\\"\")}"
  ],
  "process.command_line.text": [
    "\"powershell.exe\" & {# Add user32.dll for keybd_event\nAdd-Type @\\\"\"\n    using System;\n    using System.Runtime.InteropServices;\n    public class K {\n        [DllImport(\\\"\"user32.dll\\\"\")]\n        public static extern void keybd_event(byte bVk, byte bScan, uint dwFlags, UIntPtr dwExtraInfo);\n    }\n\\\"\"@\n\n# Virtual key codes\n$VK_LWIN, $VK_R, $KEYDOWN, $KEYUP = 0x5B, 0x52, 0x0000, 0x0002\n\n# Open Run dialog (Win+R)\n[K]::keybd_event($VK_LWIN, 0, $KEYDOWN, [UIntPtr]::Zero)\n[K]::keybd_event($VK_R, 0, $KEYDOWN, [UIntPtr]::Zero)\n[K]::keybd_event($VK_R, 0, $KEYUP, [UIntPtr]::Zero)\n[K]::keybd_event($VK_LWIN, 0, $KEYUP, [UIntPtr]::Zero)\n\n# Short delay for Run dialog\nStart-Sleep -Milliseconds 500\nAdd-Type -AssemblyName System.Windows.Forms\n[System.Windows.Forms.SendKeys]::SendWait(\\\"\"cmd /c powershell -ec \\\"\" + [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes('calc.exe')) + \\\"\"{ENTER}\\\"\")}"
  ],
  "process.entity_id": [
    "{9602231E-29C7-68C8-C101-000000004200}"
  ],
  "process.executable": [
    "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
  ],
  "process.executable.text": [
    "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
  ],
  "process.hash.sha256": [
    "9785001b0dcf755eddb8af294a373c0b87b2498660f724e76c4d53f9c217c7a3"
  ],
  "process.name": [
    "powershell.exe"
  ],
  "process.name.text": [
    "powershell.exe"
  ],
  "process.parent.pid": [
    2012
  ],
  "process.pe.company": [
    "Microsoft Corporation"
  ],
  "process.pe.description": [
    "Windows PowerShell"
  ],
  "process.pe.file_version": [
    "10.0.19041.3996 (WinBuild.160101.0800)"
  ],
  "process.pe.imphash": [
    "3d08f4848535206d772de145804ff4b6"
  ],
  "process.pe.original_file_name": [
    "PowerShell.EXE"
  ],
  "process.pe.product": [
    "Microsoft® Windows® Operating System"
  ],
  "process.pid": [
    3376
  ],
  "process.working_directory": [
    "C:\\Users\\KHAIRE~1\\AppData\\Local\\Temp\\"
  ],
  "process.working_directory.text": [
    "C:\\Users\\KHAIRE~1\\AppData\\Local\\Temp\\"
  ],
  "related.hash": [
    "9785001b0dcf755eddb8af294a373c0b87b2498660f724e76c4d53f9c217c7a3",
    "3d08f4848535206d772de145804ff4b6"
  ],
  "related.user": [
    "khaireddine"
  ],
  "user.domain": [
    "WINDOWS10"
  ],
  "user.id": [
    "S-1-5-18"
  ],
  "user.name": [
    "khaireddine"
  ],
  "user.name.text": [
    "khaireddine"
  ],
  "winlog.channel": [
    "Microsoft-Windows-Sysmon/Operational"
  ],
  "winlog.computer_name": [
    "windows10"
  ],
  "winlog.event_data.Company": [
    "Microsoft Corporation"
  ],
  "winlog.event_data.Description": [
    "Windows PowerShell"
  ],
  "winlog.event_data.FileVersion": [
    "10.0.19041.3996 (WinBuild.160101.0800)"
  ],
  "winlog.event_data.IntegrityLevel": [
    "High"
  ],
  "winlog.event_data.LogonGuid": [
    "{9602231E-1740-68C8-17F0-250000000000}"
  ],
  "winlog.event_data.LogonId": [
    "0x25f017"
  ],
  "winlog.event_data.Product": [
    "Microsoft® Windows® Operating System"
  ],
  "winlog.event_data.TerminalSessionId": [
    "0"
  ],
  "winlog.event_id": [
    "1"
  ],
  "winlog.opcode": [
    "Info"
  ],
  "winlog.process.pid": [
    3004
  ],
  "winlog.process.thread.id": [
    3852
  ],
  "winlog.provider_guid": [
    "{5770385F-C22A-43E0-BF4C-06F5698FFBD9}"
  ],
  "winlog.provider_name": [
    "Microsoft-Windows-Sysmon"
  ],
  "winlog.record_id": [
    "713879"
  ],
  "winlog.task": [
    "Process Create (rule: ProcessCreate)"
  ],
  "winlog.user.domain": [
    "NT AUTHORITY"
  ],
  "winlog.user.identifier": [
    "S-1-5-18"
  ],
  "winlog.user.name": [
    "SYSTEM"
  ],
  "winlog.user.type": [
    "User"
  ],
  "winlog.version": [
    5
  ],
  "_id": "IrTjTZkBzsje1w8G1BFO",
  "_index": ".ds-winlogbeat-9.1.2-2025.08.17-000001",
  "_score": null
}